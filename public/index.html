<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>Stateful OSC Relay - WebUI</title>

		<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.1/css/bootstrap.min.css" rel="stylesheet">
		<style>

		.main-nav {
			padding-top: 20px;
		}

		@media (min-width: 768px) {
			.main-nav {
				padding-top: 100px;
			}
		}

		</style>


		<!--script src="//netdna.bootstrapcdn.com/bootstrap/3.0.1/js/bootstrap.min.js"></script-->
		<script src="//code.jquery.com/jquery-1.10.1.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			$(function() {
				var
					$tbody = $('.guest-table tbody'),
					sourceNames = {z: 'Zeroconf', s: 'Static'};

				var socket = io.connect(window.location.protocol+'//'+window.location.host, {
					'reconnection limit': 5000,
					'sync disconnect on unload': true
				});

				socket.on('update', function(reason, bundle) {
					console.log('update because of', reason, bundle);

					// clean and re-fill guest table
					$tbody.find('> tr').remove();
					for(var i = 0; i < bundle.g.length; i++) {
						var guest = bundle.g[i];

						$('<tr>')
							.appendTo($tbody)
							.append($('<td>').text(guest.n))
							.append($('<td>').text(guest.a + ':' + guest.p))
							.append($('<td>').text(  sourceNames[guest.s]  ));
					};
				})
			});
		</script>
	</head>

	<body>
		<div class="container">
			<div class="row">
				<div class="main-nav col-sm-3">
					<ul class="nav nav-pills nav-stacked">
						<li class="active"><a href="#">Devices</a></li>
						<li><a href="#">Presets</a></li>
						<li><a href="#">Config</a></li>
						<li><a href="#">Message I/O</a></li>
						<li><a href="#">Log</a></li>
					</ul>
				</div><!-- col-3 -->
				<div class="col-sm-9">


					<h2>Devices</h2>
					<table class="table table-striped guest-table">
						<thead>
							<tr>
								<th>Guest Name</th>
								<th>IPv4 Adress</th>
								<th>Source</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>


				</div><!-- col-10 -->
			</div><!-- row -->
		</div><!-- container -->
	</body>
</html>
